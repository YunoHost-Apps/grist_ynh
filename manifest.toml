#:schema https://raw.githubusercontent.com/YunoHost/apps/master/schemas/manifest.v2.schema.json

packaging_format = 2

id = "grist"
name = "Grist"
description.en = "Modern relational spreadsheet"
description.fr = "Feuille de calcul relationnelle moderne"

version = "1.7.3~ynh3"

maintainers = ["fflorent"]

[upstream]
license = "Apache-2.0"
website = "https://getgrist.com"
demo = "https://docs.getgrist.com"
admindoc = "https://www.getgrist.com/product/self-managed/"
userdoc = "https://support.getgrist.com/"
code = "https://github.com/gristlabs/grist-core/"
fund = "https://github.com/sponsors/gristlabs"

[integration]
yunohost = ">= 12.1.17"
helpers_version = "2.1"
architectures = "all"
multi_instance = true

ldap = true
sso = true

disk = "1.5G"
ram.build = "1500M"
ram.runtime = "150M"

[install]
    [install.domain]
    type = "domain"

    [install.init_main_permission]
    type = "group"
    default = "visitors"

    [install.language]
    ask.en = "Choose the application language"
    ask.fr = "Choisissez la langue de l'application"
    type = "select"
    # See https://github.com/gristlabs/grist-core/blob/b9a691ef28ef9047c9ff5ec089a8a70f8e8a609d/app/common/LocaleCodes.ts#L18
    # FIXME: in the config panel instead, and defaults to en-US
# FIXME: Fix https://github.com/YunoHost-Apps/grist_ynh/issues/87
    choices = ["af-ZA", "ak-GH", "am-ET", "ar-AE", "ar-BH", "ar-DZ", "ar-EG", "ar-IN", "ar-IQ", "ar-JO", "ar-KW", "ar-LB", "ar-LY", "ar-MA", "ar-OM", "ar-QA", "ar-SA", "ar-SD", "ar-SS", "ar-SY", "ar-TN", "ar-YE", "as-IN", "ast-ES", "az-AZ", "az-IR", "be-BY", "bem-ZM", "bg-BG", "bn-BD", "bn-IN", "bo-CN", "bo-IN", "br-FR", "brx-IN", "bs-BA", "ca-AD", "ca-ES", "ca-FR", "ca-IT", "ce-RU", "chr-US", "ckb-IQ", "cs-CZ", "cy-GB", "da-DK", "de-AT", "de-BE", "de-CH", "de-DE", "de-IT", "de-LI", "de-LU", "doi-IN", "dz-BT", "el-CY", "el-GR", "en-AG", "en-AU", "en-BW", "en-CA", "en-DK", "en-GB", "en-HK", "en-IE", "en-IL", "en-IN", "en-NG", "en-NZ", "en-PH", "en-SC", "en-SG", "en-US", "en-ZA", "en-ZM", "en-ZW", "es-AR", "es-BO", "es-CL", "es-CO", "es-CR", "es-CU", "es-DO", "es-EC", "es-ES", "es-GT", "es-HN", "es-MX", "es-NI", "es-PA", "es-PE", "es-PR", "es-PY", "es-SV", "es-US", "es-UY", "es-VE", "et-EE", "eu-ES", "fa-IR", "ff-SN", "fi-FI", "fil-PH", "fo-FO", "fr-BE", "fr-CA", "fr-CH", "fr-FR", "fr-LU", "fur-IT", "fy-DE", "fy-NL", "ga-IE", "gd-GB", "gl-ES", "gu-IN", "gv-GB", "ha-NG", "he-IL", "hi-IN", "hr-HR", "hsb-DE", "hu-HU", "hy-AM", "ia-FR", "id-ID", "ig-NG", "is-IS", "it-CH", "it-IT", "ja-JP", "kab-DZ", "ka-GE", "kk-KZ", "kl-GL", "km-KH", "kn-IN", "kok-IN", "ko-KR", "ks-IN", "ku-TR", "kw-GB", "ky-KG", "lb-LU", "lg-UG", "ln-CD", "lo-LA", "lt-LT", "lv-LV", "mai-IN", "mai-NP", "mfe-MU", "mg-MG", "mi-NZ", "mk-MK", "ml-IN", "mni-IN", "mn-MN", "mr-IN", "ms-MY", "mt-MT", "my-MM", "ne-NP", "nl-AW", "nl-BE", "nl-NL", "nn-NO", "om-ET", "om-KE", "or-IN", "os-RU", "pa-IN", "pa-PK", "pl-PL", "ps-AF", "pt-BR", "pt-PT", "ro-RO", "ru-RU", "ru-UA", "rw-RW", "sa-IN", "sat-IN", "sd-IN", "se-NO", "si-LK", "sk-SK", "sl-SI", "so-DJ", "so-ET", "so-KE", "so-SO", "sq-AL", "sq-MK", "sr-ME", "sr-RS", "sv-FI", "sv-SE", "sw-KE", "sw-TZ", "ta-IN", "ta-LK", "te-IN", "tg-TJ", "th-TH", "ti-ER", "ti-ET", "tk-TM", "to-TO", "tr-CY", "tr-TR", "tt-RU", "ug-CN", "uk-UA", "ur-IN", "ur-PK", "uz-UZ", "vi-VN", "wae-CH", "wo-SN", "xh-ZA", "yi-US", "yo-NG", "yue-HK", "zh-CN", "zh-HK", "zh-SG", "zh-TW", "zu-ZA"]
    default = "en-US"

    [install.admin]
    type = "user"

[resources]

    [resources.sources]
    [resources.sources.main]
    url = "https://github.com/gristlabs/grist-core/archive/refs/tags/v1.7.3.tar.gz"
    sha256 = "af6beeb4ce095520f15ec4b73961cfba53384a37006c82d1f1c271274082f8e1"

    autoupdate.strategy = "latest_github_release"

    [resources.system_user]

    [resources.install_dir]

    [resources.data_dir]

    [resources.permissions]
    main.url = "/"
    login.url = "/auth/login"
    login.show_tile = false
    login.allowed = "all_users"
    api.url = "/api"
    api.show_tile = false
    api.allowed = "visitors"

    [resources.ports]
    main.default = 8484

    [resources.apt]
    packages = "python3, python3-venv, redis-server"

    [resources.nodejs]
    version = "22"
